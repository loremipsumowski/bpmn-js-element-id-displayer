!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.BpmnJsElementIdDisplayer=t():e.BpmnJsElementIdDisplayer=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var s in n)e.o(n,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:n[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};function n(e,t){var n=this;t=t||1e3,e.on(["render.shape","render.connection"],t,(function(e,t){var s=e.type,r=t.element,o=t.gfx,i=t.attrs;if(n.canRender(r))return"render.shape"===s?n.drawShape(o,r,i):n.drawConnection(o,r,i)})),e.on(["render.getShapePath","render.getConnectionPath"],t,(function(e,t){if(n.canRender(t))return"render.getShapePath"===e.type?n.getShapePath(t):n.getConnectionPath(t)}))}function s(e,t){return function(e,t){t.appendChild(function(e,t){if(e.ownerDocument!==t.ownerDocument)try{return t.ownerDocument.importNode(e,!0)}catch(e){}return e}(e,t))}(t,e),e}e.r(t),e.d(t,{default:()=>g}),n.prototype.canRender=function(){},n.prototype.drawShape=function(){},n.prototype.drawConnection=function(){},n.prototype.getShapePath=function(){},n.prototype.getConnectionPath=function(){};var r=2,o={"alignment-baseline":1,"baseline-shift":1,clip:1,"clip-path":1,"clip-rule":1,color:1,"color-interpolation":1,"color-interpolation-filters":1,"color-profile":1,"color-rendering":1,cursor:1,direction:1,display:1,"dominant-baseline":1,"enable-background":1,fill:1,"fill-opacity":1,"fill-rule":1,filter:1,"flood-color":1,"flood-opacity":1,font:1,"font-family":1,"font-size":r,"font-size-adjust":1,"font-stretch":1,"font-style":1,"font-variant":1,"font-weight":1,"glyph-orientation-horizontal":1,"glyph-orientation-vertical":1,"image-rendering":1,kerning:1,"letter-spacing":1,"lighting-color":1,marker:1,"marker-end":1,"marker-mid":1,"marker-start":1,mask:1,opacity:1,overflow:1,"pointer-events":1,"shape-rendering":1,"stop-color":1,"stop-opacity":1,stroke:1,"stroke-dasharray":1,"stroke-dashoffset":1,"stroke-linecap":1,"stroke-linejoin":1,"stroke-miterlimit":1,"stroke-opacity":1,"stroke-width":r,"text-anchor":1,"text-decoration":1,"text-rendering":1,"unicode-bidi":1,visibility:1,"word-spacing":1,"writing-mode":1};function i(e,t,n){var s=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),i=o[s];i?(i===r&&"number"==typeof n&&(n=String(n)+"px"),e.style[s]=n):e.setAttributeNS(null,t,n)}function a(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}var l=/\s+/,c=Object.prototype.toString;function d(e){return void 0!==e}function p(e){if(!e||!e.nodeType)throw new Error("A DOM element reference is required");this.el=e,this.list=e.classList}p.prototype.add=function(e){if(this.list)return this.list.add(e),this;var t=this.array();return~a(t,e)||t.push(e),d(this.el.className.baseVal)?this.el.className.baseVal=t.join(" "):this.el.className=t.join(" "),this},p.prototype.remove=function(e){if("[object RegExp]"===c.call(e))return this.removeMatching(e);if(this.list)return this.list.remove(e),this;var t=this.array(),n=a(t,e);return~n&&t.splice(n,1),this.el.className.baseVal=t.join(" "),this},p.prototype.removeMatching=function(e){for(var t=this.array(),n=0;n<t.length;n++)e.test(t[n])&&this.remove(t[n]);return this},p.prototype.toggle=function(e,t){return this.list?(d(t)?t!==this.list.toggle(e,t)&&this.list.toggle(e):this.list.toggle(e),this):(d(t)?t?this.add(e):this.remove(e):this.has(e)?this.remove(e):this.add(e),this)},p.prototype.array=function(){var e=(this.el.getAttribute("class")||"").replace(/^\s+|\s+$/g,"").split(l);return""===e[0]&&e.shift(),e},p.prototype.has=p.prototype.contains=function(e){return this.list?this.list.contains(e):!!~a(this.array(),e)};var h={svg:"http://www.w3.org/2000/svg"},u='<svg xmlns="'+h.svg+'"';function m(e,t){var n;return"<"===e.charAt(0)?(n=function(e){var t=!1;"<svg"===e.substring(0,4)?-1===e.indexOf(h.svg)&&(e=u+e.substring(4)):(e=u+">"+e+"</svg>",t=!0);var n=function(e){var t;return(t=new DOMParser).async=!1,t.parseFromString(e,"text/xml")}(e);if(!t)return n;for(var s=document.createDocumentFragment(),r=n.firstChild;r.firstChild;)s.appendChild(r.firstChild);return s}(e).firstChild,n=document.importNode(n,!0)):n=document.createElementNS(h.svg,e),t&&function(e,t,n){if("string"==typeof t){if(void 0===n)return function(e,t){return o[t]?e.style[t]:e.getAttributeNS(null,t)}(e,t);i(e,t,n)}else!function(e,t){var n,s,r=Object.keys(t);for(n=0;s=r[n];n++)i(e,s,t[s])}(e,t)}(n,t),n}const f=[{type:"tasks",label:"Tasks"},{type:"events",label:"Events"},{type:"gateways",label:"Gateways"},{type:"sequenceFlows",label:"Sequence Flows"},{type:"dataObjects",label:"Data Objects"},{type:"others",label:"Others"}];class y extends n{constructor(e,t,n,s){super(e,1500),this.canvas=t,this.eventBus=e,this.bpmnRenderer=n,this.textRenderer=s,this.showIds=!1,this.elementTypesToShow=new Set,this._loadSettingsFromLocalStorage(),this._init()}canRender(e){return function(e,t){var n=function(e){return e&&e.businessObject||e}(e);return n&&"function"==typeof n.$instanceOf&&n.$instanceOf(t)}(e,"bpmn:BaseElement")&&!e.labelTarget}drawShape(e,t){const n=this.bpmnRenderer.drawShape(e,t);if("label"===t.type||t.labelTarget||!this.showIds||!this._shouldShowId(t))return n;const r=m("text");return r.textContent=t.id,r.setAttribute("font-size","12px"),r.setAttribute("fill","#0000ff"),r.setAttribute("text-anchor","middle"),r.setAttribute("x",t.width/2),r.setAttribute("y",-5),s(e,r),n}drawConnection(e,t){const n=this.bpmnRenderer.drawConnection(e,t);if("label"===t.type||t.labelTarget||!this.showIds||!this._shouldShowId(t))return n;const r=m("text");r.textContent=t.id,r.setAttribute("font-size","12px"),r.setAttribute("fill","#0000ff"),r.setAttribute("text-anchor","middle");const o=this.getMidPoint(t.waypoints);return r.setAttribute("x",o.x),r.setAttribute("y",o.y-5),s(e,r),n}getMidPoint(e){const t=Math.floor(e.length/2),n=e[t-1],s=e[t];return{x:(n.x+s.x)/2,y:(n.y+s.y)/2}}_init(){const e=this.canvas.getContainer(),t=this._parent=document.createElement("div");t.className="djs-element-id-displayer",e.appendChild(t),this._addToggleControl(t)}_addToggleControl(e){const t=document.createElement("div");t.id="toggle-container",t.style.position="absolute",t.style.top="10px",t.style.right="10px",t.style.width="150px",t.style.background="#fff",t.style.border="1px solid #ccc",t.style.padding="10px",t.style.zIndex=1e3,t.style.display="flex",t.style.flexDirection="column";const n=document.createElement("div");n.style.display="flex",n.style.alignItems="center",n.style.cursor="pointer";const s=document.createElement("input");s.type="checkbox",s.id="toggle-ids",s.checked=this.showIds;const r=document.createElement("label");r.setAttribute("for","toggle-ids"),r.textContent="Show IDs",n.appendChild(s),n.appendChild(r),t.appendChild(n);const o=document.createElement("div");o.style.flexDirection="column",o.style.marginTop="10px",o.style.display=this.showIds?"flex":"none",f.forEach((e=>{const t=document.createElement("input");t.type="checkbox",t.id=`toggle-${e.type}`,t.checked=this.elementTypesToShow.has(e.type);const n=document.createElement("label");n.setAttribute("for",`toggle-${e.type}`),n.textContent=e.label,t.addEventListener("change",(()=>{t.checked?this.elementTypesToShow.add(e.type):this.elementTypesToShow.delete(e.type),this._saveSettingsToLocalStorage(),this._updateDiagram()})),o.appendChild(this._createCheckboxLabelPair(t,n))})),t.appendChild(o),e.appendChild(t),s.addEventListener("change",(()=>{this.showIds=s.checked,o.style.display=this.showIds?"flex":"none",this._saveSettingsToLocalStorage(),this._updateDiagram()})),t.addEventListener("mouseenter",(()=>{o.style.display="flex"})),t.addEventListener("mouseleave",(()=>{o.style.display=this.showIds?"flex":"none"}))}_createCheckboxLabelPair(e,t){const n=document.createElement("div");return n.style.display="flex",n.style.alignItems="center",n.style.marginBottom="5px",n.appendChild(e),n.appendChild(t),n}_shouldShowId(e){const t=function(e){switch(e){case"bpmn:Task":case"bpmn:ServiceTask":case"bpmn:ReceiveTask":case"bpmn:UserTask":case"bpmn:ManualTask":case"bpmn:ScriptTask":case"bpmn:BusinessRuleTask":case"bpmn:SendTask":return f[0];case"bpmn:StartEvent":case"bpmn:EndEvent":case"bpmn:IntermediateThrowEvent":case"bpmn:BoundaryEvent":case"bpmn:IntermediateCatchEvent":return f[1];case"bpmn:ExclusiveGateway":case"bpmn:InclusiveGateway":case"bpmn:ParallelGateway":case"bpmn:EventBasedGateway":return f[2];case"bpmn:SequenceFlow":return f[3];case"bpmn:DataObjectReference":case"bpmn:DataStoreReference":case"bpmn:DataInput":case"bpmn:DataOutput":return f[4];default:return f[5]}}(e.type);return this.elementTypesToShow.has(t.type)}_updateDiagram(){const e=this._getAllElements();this.eventBus.fire("elements.changed",{elements:e})}_getAllElements(){const e=[];return this.canvas.getRootElement().children.forEach((function t(n){e.push(n),n.children&&n.children.forEach(t)})),e}_loadSettingsFromLocalStorage(){const e=localStorage.getItem("showIds");null!==e&&(this.showIds=JSON.parse(e));const t=localStorage.getItem("elementTypesToShow");null!==t&&(this.elementTypesToShow=new Set(JSON.parse(t)))}_saveSettingsToLocalStorage(){localStorage.setItem("showIds",JSON.stringify(this.showIds)),localStorage.setItem("elementTypesToShow",JSON.stringify(Array.from(this.elementTypesToShow)))}}y.$inject=["eventBus","canvas","bpmnRenderer","textRenderer"];const g={__init__:["elementIdDisplayer"],elementIdDisplayer:["type",y]};return t})()));
//# sourceMappingURL=bpmn-js-element-id-displayer.bundle.js.map